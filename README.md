# AIRPè®°å¿†å¢å¼ºç³»ç»Ÿ - Graphiti + DeepSeek + SillyTaverné›†æˆ

åŸºäºGraphitiçŸ¥è¯†å›¾è°±çš„è®°å¿†å¢å¼ºç³»ç»Ÿï¼Œä¸ºSillyTavernæä¾›OpenAIå…¼å®¹APIï¼Œå®ç°æŒä¹…åŒ–è®°å¿†ç®¡ç†å’Œæ™ºèƒ½æ£€ç´¢ã€‚

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„è®°å¿†å¢å¼ºAPIç³»ç»Ÿï¼Œä¸»è¦ç‰¹æ€§åŒ…æ‹¬ï¼š

- **çŸ¥è¯†å›¾è°±å­˜å‚¨**ï¼šä½¿ç”¨Neo4j + Graphitiæ„å»ºæ—¶åºæ„ŸçŸ¥çŸ¥è¯†å›¾è°±
- **æ™ºèƒ½è®°å¿†æ£€ç´¢**ï¼šæ··åˆæ£€ç´¢ï¼ˆå‘é‡+å›¾ï¼‰+ Rerankeré‡æ’åº
- **SillyTaverné›†æˆ**ï¼šè§£æSillyTavernç‰¹æ®Šæ ¼å¼æ–‡æœ¬
- **OpenAIå…¼å®¹API**ï¼šå®Œå…¨å…¼å®¹OpenAI Chat Completions API
- **DeepSeek LLM**ï¼šä½¿ç”¨DeepSeek V3è¿›è¡Œæ¨ç†
- **ç¡…åŸºæµåŠ¨Embedding**ï¼šä½¿ç”¨BAAIç³»åˆ—æ¨¡å‹è¿›è¡Œå‘é‡åµŒå…¥

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SillyTavern                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ OpenAIå…¼å®¹API
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FastAPIæœåŠ¡ (ç«¯å£8000)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  1. SillyTavernæ ¼å¼è§£æå™¨                        â”‚  â”‚
â”‚  â”‚     - æå–æŒ‡ä»¤æ€§å†…å®¹                               â”‚  â”‚
â”‚  â”‚     - æå–å™äº‹æ€§å†…å®¹                               â”‚  â”‚
â”‚  â”‚     - è§£æå¯¹è¯å†å²                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  2. Graphitiè®°å¿†æœåŠ¡                              â”‚  â”‚
â”‚  â”‚     - Episodeæ·»åŠ                                   â”‚  â”‚
â”‚  â”‚     - è®°å¿†æ£€ç´¢ï¼ˆæ··åˆæ£€ç´¢ï¼‰                         â”‚  â”‚
â”‚  â”‚     - Rerankeré‡æ’åº                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  3. ä¸Šä¸‹æ–‡ä¼˜åŒ–å™¨                                  â”‚  â”‚
â”‚  â”‚     - ä¿ç•™æŒ‡ä»¤æ€§å†…å®¹                               â”‚  â”‚
â”‚  â”‚     - æ›¿æ¢å™äº‹æ€§å†…å®¹                               â”‚  â”‚
â”‚  â”‚     - Tokenä¼˜åŒ–                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  4. LLMè°ƒç”¨æ¥å£                                  â”‚  â”‚
â”‚  â”‚     - DeepSeek V3è°ƒç”¨                            â”‚  â”‚
â”‚  â”‚     - å¼‚æ­¥å“åº”åå¤„ç†                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                   â”‚
           â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Neo4jçŸ¥è¯†å›¾è°±    â”‚           â”‚   DeepSeek V3 LLM        â”‚
â”‚  + Graphiti Core   â”‚           â”‚  (betaç«¯ç‚¹ï¼ŒStrictæ¨¡å¼)   â”‚
â”‚  - å®ä½“/å…³ç³»å­˜å‚¨   â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  - å‘é‡ç´¢å¼•        â”‚                    â”‚
â”‚  - å›¾éå†æ£€ç´¢      â”‚                    â–¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   ç¡…åŸºæµåŠ¨API            â”‚
                                â”‚  - Embedding (BAAI/bge-m3)â”‚
                                â”‚  - Reranker (bge-reranker)â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Dockerå’ŒDocker Compose v2
- Python 3.11+ï¼ˆæœ¬åœ°å¼€å‘ï¼‰
- DeepSeek APIå¯†é’¥
- ç¡…åŸºæµåŠ¨APIå¯†é’¥

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/2211427551/Exp_Graphiti_MemR3_AIRP_Intergration.git
cd Exp_Graphiti_MemR3_AIRP_Intergration
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶`.env.example`åˆ°`.env`å¹¶å¡«å…¥å®é™…å€¼ï¼š

```bash
cd api-service
cp .env.example .env
```

ç¼–è¾‘`.env`æ–‡ä»¶ï¼Œå¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š

```env
# Neo4jé…ç½®
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=your_secure_password_here

# DeepSeek LLMé…ç½®
DEEPSEEK_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxx
DEEPSEEK_BASE_URL=https://api.deepseek.com/beta
DEEPSEEK_MODEL=deepseek-chat
DEEPSEEK_SMALL_MODEL=deepseek-chat

# ç¡…åŸºæµåŠ¨é…ç½®
SILICONFLOW_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxx
SILICONFLOW_BASE_URL=https://api.siliconflow.cn/v1
SILICONFLOW_EMBEDDING_MODEL=BAAI/bge-m3
SILICONFLOW_EMBEDDING_DIM=1024
SILICONFLOW_RERANKER_MODEL=BAAI/bge-reranker-v2-m3

# APIæœåŠ¡é…ç½®
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=3
API_SEMAPHORE_LIMIT=5

# åº”ç”¨é…ç½®
APP_ENV=production
APP_SECRET_KEY=your_secret_key_change_this_in_production
```

### 3. å¯åŠ¨æœåŠ¡

ä½¿ç”¨Docker Composeå¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼š

```bash
# å›åˆ°é¡¹ç›®æ ¹ç›®å½•
cd ..

# å¯åŠ¨Neo4jå’ŒAPIæœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f api
```

æœåŠ¡å¯åŠ¨åï¼š
- **Neo4j**: http://localhost:7474
- **API**: http://localhost:8000
- **APIæ–‡æ¡£**: http://localhost:8000/docs

### 4. éªŒè¯å®‰è£…

æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€ï¼š

```bash
curl http://localhost:8000/health
```

é¢„æœŸå“åº”ï¼š

```json
{
  "status": "healthy",
  "timestamp": "2026-01-05T12:00:00",
  "version": "1.0.0"
}
```

## ğŸ”§ SillyTaverné…ç½®

### 1. æ·»åŠ è‡ªå®šä¹‰ç«¯ç‚¹

åœ¨SillyTavernä¸­ï¼š

1. æ‰“å¼€è®¾ç½® â†’ APIè¿æ¥
2. ç‚¹å‡»"æ·»åŠ æ–°ç«¯ç‚¹"
3. é…ç½®å¦‚ä¸‹ï¼š

```
åç§°: AIRP Memory System
URL: http://localhost:8000/v1
APIå¯†é’¥: (ç•™ç©º)
ç±»å‹: OpenAIå…¼å®¹
```

### 2. é€‰æ‹©æ¨¡å‹

```
æ¨¡å‹: deepseek-chat
```

### 3. ä½¿ç”¨SillyTavernæ ¼å¼

åœ¨SillyTavernçš„æç¤ºè¯ä¸­ä½¿ç”¨æ ‡å‡†æ ¼å¼ï¼š

```
<æ ¸å¿ƒæŒ‡å¯¼>
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„AIåŠ©æ‰‹ï¼Œæ“…é•¿è®°å¿†å’Œä¸Šä¸‹æ–‡ç†è§£ã€‚
</æ ¸å¿ƒæŒ‡å¯¼>

<ç›¸å…³èµ„æ–™>
åœ°ç‚¹(å›¾ä¹¦é¦†): ä¸€ä¸ªå®‰é™çš„åœ°æ–¹ï¼Œæœ‰å¾ˆå¤šä¹¦ç±
è§’è‰²(å¼ ä¸‰): 25å²ï¼Œå–œæ¬¢é˜…è¯»
</ç›¸å…³èµ„æ–™>

ç”¨æˆ·ï¼šå‘Šè¯‰æˆ‘å…³äºå¼ ä¸‰çš„ä¿¡æ¯
```

ç³»ç»Ÿä¼šè‡ªåŠ¨ï¼š
- è§£ææ ‡ç­¾å†…å®¹
- æå–å®ä½“å’Œå…³ç³»
- å­˜å‚¨åˆ°çŸ¥è¯†å›¾è°±
- æ£€ç´¢ç›¸å…³è®°å¿†
- ä¼˜åŒ–ä¸Šä¸‹æ–‡
- ç”Ÿæˆå¢å¼ºå“åº”

## ğŸ“ é¡¹ç›®ç»“æ„

```
Exp_Graphiti_MemR3_AIRP_Intergration/
â”œâ”€â”€ api-service/                 # APIæœåŠ¡ä¸»ç›®å½•
â”‚   â”œâ”€â”€ main.py                # FastAPIåº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ Dockerfile             # APIæœåŠ¡Dockeré•œåƒ
â”‚   â”œâ”€â”€ requirements.txt        # Pythonä¾èµ–
â”‚   â”œâ”€â”€ .env.example          # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”‚   â”œâ”€â”€ config/               # é…ç½®æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ settings.py       # åº”ç”¨é…ç½®
â”‚   â”‚   â””â”€â”€ graphiti_config.py # Graphitiå®¢æˆ·ç«¯é…ç½®
â”‚   â”œâ”€â”€ models/               # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ requests.py      # è¯·æ±‚æ¨¡å‹
â”‚   â”‚   â””â”€â”€ responses.py     # å“åº”æ¨¡å‹
â”‚   â”œâ”€â”€ services/            # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ parser_service.py     # SillyTavernè§£æå™¨
â”‚   â”‚   â”œâ”€â”€ graphiti_service.py   # GraphitiæœåŠ¡å°è£…
â”‚   â”‚   â””â”€â”€ llm_service.py       # LLMæœåŠ¡å°è£…
â”‚   â””â”€â”€ utils/               # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ logger.py       # æ—¥å¿—é…ç½®
â”‚       â””â”€â”€ helpers.py     # è¾…åŠ©å‡½æ•°
â”œâ”€â”€ docker-compose.yaml     # Docker Composeé…ç½®
â”œâ”€â”€ .env                   # ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤åˆ°gitï¼‰
â”œâ”€â”€ .gitignore            # Gitå¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md             # é¡¹ç›®æ–‡æ¡£
```

## ğŸ”‘ APIç«¯ç‚¹

### å¥åº·æ£€æŸ¥

```http
GET /health
```

**å“åº”**:

```json
{
  "status": "healthy",
  "timestamp": "2026-01-05T12:00:00",
  "version": "1.0.0"
}
```

### Chat Completionsï¼ˆOpenAIå…¼å®¹ï¼‰

```http
POST /v1/chat/completions
Content-Type: application/json
X-Session-ID: sess-abc123

{
  "model": "deepseek-chat",
  "messages": [
    {
      "role": "system",
      "content": "ä½ æ˜¯AIåŠ©æ‰‹"
    },
    {
      "role": "user",
      "content": "<æ ¸å¿ƒæŒ‡å¯¼>è®°ä½è¿™äº›ä¿¡æ¯</æ ¸å¿ƒæŒ‡å¯¼>ç”¨æˆ·ï¼šä½ å¥½"
    }
  ],
  "temperature": 0.7,
  "max_tokens": 4096
}
```

**å“åº”**:

```json
{
  "id": "chatcmpl-xxx",
  "object": "chat.completion",
  "created": 1704436800,
  "model": "deepseek-chat",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "ä½ å¥½ï¼æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 100,
    "completion_tokens": 50,
    "total_tokens": 150
  },
  "extra": {
    "memories_used": 5
  }
}
```

## ğŸ§  è®°å¿†ç³»ç»Ÿå·¥ä½œåŸç†

### 1. å†…å®¹è§£æ

ç³»ç»Ÿè§£æSillyTavernæ ¼å¼æ–‡æœ¬ï¼Œè¯†åˆ«ï¼š

- **æŒ‡ä»¤æ€§å†…å®¹**ï¼ˆä¸å…¥å›¾è°±ï¼‰ï¼š
  - æ ¸å¿ƒæŒ‡å¯¼
  - åŸºç¡€é£æ ¼
  - è¡¥å……èµ„æ–™

- **å™äº‹æ€§å†…å®¹**ï¼ˆå…¥å›¾è°±ï¼‰ï¼š
  - ä¸–ç•Œä¹¦ä¿¡æ¯
  - å¯¹è¯å†å²
  - ä¸€èˆ¬å†…å®¹

### 2. çŸ¥è¯†å›¾è°±å­˜å‚¨

```
ç”¨æˆ·è¾“å…¥ â†’ è§£æ â†’ å®ä½“æå– â†’ å…³ç³»æ„å»º â†’ å­˜å‚¨åˆ°Neo4j
```

- ä½¿ç”¨Graphitiçš„`add_episode()`æ–¹æ³•
- è‡ªåŠ¨æå–å®ä½“å’Œå…³ç³»
- æ„å»ºå‘é‡ç´¢å¼•
- æ”¯æŒæ—¶åºæŸ¥è¯¢

### 3. æ™ºèƒ½æ£€ç´¢

```
æŸ¥è¯¢é—®é¢˜ â†’ Graphiti.search() â†’ æ··åˆæ£€ç´¢ â†’ Rerankeré‡æ’åº â†’ è¿”å›ç›¸å…³è®°å¿†
```

- å‘é‡æ£€ç´¢ï¼šåŸºäºè¯­ä¹‰ç›¸ä¼¼åº¦
- å›¾æ£€ç´¢ï¼šåŸºäºå®ä½“å…³ç³»
- Rerankerï¼šç²¾ç»†åŒ–é‡æ’åº

### 4. ä¸Šä¸‹æ–‡ä¼˜åŒ–

```
åŸå§‹ä¸Šä¸‹æ–‡ + ç›¸å…³è®°å¿† â†’ ä¼˜åŒ– â†’ å¢å¼ºæç¤ºè¯ â†’ LLMè°ƒç”¨
```

- ä¿ç•™æ‰€æœ‰æŒ‡ä»¤æ€§å†…å®¹
- ç”¨è®°å¿†æ›¿æ¢éƒ¨åˆ†å™äº‹æ€§å†…å®¹
- Tokenæ•°é‡ä¼˜åŒ–
- æœ€è¿‘å¯¹è¯å†å²ä¿ç•™

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘

```bash
# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
cd api-service
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ– venv\Scripts\activate  # Windows

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘.envå¡«å…¥é…ç½®

# 4. å¯åŠ¨Neo4jï¼ˆä½¿ç”¨Dockerï¼‰
cd ..
docker-compose up -d neo4j

# 5. è¿è¡ŒAPIæœåŠ¡
cd api-service
python main.py
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
pytest tests/

# è¿è¡Œé›†æˆæµ‹è¯•
pytest tests/integration/

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=. tests/
```

### æ·»åŠ æ–°åŠŸèƒ½

1. åœ¨`models/`ä¸­å®šä¹‰æ•°æ®æ¨¡å‹
2. åœ¨`services/`ä¸­å®ç°ä¸šåŠ¡é€»è¾‘
3. åœ¨`main.py`ä¸­æ·»åŠ APIç«¯ç‚¹
4. æ·»åŠ æµ‹è¯•ç”¨ä¾‹

## ğŸ› æ•…éšœæ’æŸ¥

### Neo4jè¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥Neo4jå®¹å™¨çŠ¶æ€
docker-compose ps neo4j

# æŸ¥çœ‹Neo4jæ—¥å¿—
docker-compose logs neo4j

# é‡å¯Neo4j
docker-compose restart neo4j
```

### Graphitiåˆå§‹åŒ–å¤±è´¥

æ£€æŸ¥ä»¥ä¸‹é…ç½®ï¼š
- Neo4j URIæ˜¯å¦æ­£ç¡®ï¼ˆ`bolt://localhost:7687`ï¼‰
- Neo4jç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®
- DeepSeek APIå¯†é’¥æ˜¯å¦æœ‰æ•ˆ
- ç¡…åŸºæµåŠ¨APIå¯†é’¥æ˜¯å¦æœ‰æ•ˆ

### SillyTavernæ ¼å¼è§£æå¤±è´¥

ç¡®ä¿æ ¼å¼æ­£ç¡®ï¼š
```
<æ ‡ç­¾å>
å†…å®¹
</æ ‡ç­¾å>
```

### è®°å¿†æ£€ç´¢ç»“æœä¸ºç©º

å¯èƒ½åŸå› ï¼š
- çŸ¥è¯†å›¾è°±ä¸­æ²¡æœ‰ç›¸å…³è®°å¿†
- æ£€ç´¢æŸ¥è¯¢ä¸å¤Ÿå…·ä½“
- Rerankerè¿‡æ»¤è¿‡äºä¸¥æ ¼

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. Neo4jé…ç½®

åœ¨`docker-compose.yaml`ä¸­è°ƒæ•´ï¼š

```yaml
neo4j:
  environment:
    NEO4J_dbms_memory_heap_initial__size: 512m
    NEO4J_dbms_memory_heap_max__size: 2G
    NEO4J_dbms_memory_pagecache_size: 1G
```

### 2. å¹¶å‘é™åˆ¶

åœ¨`.env`ä¸­è°ƒæ•´ï¼š

```env
API_SEMAPHORE_LIMIT=10  # å¢åŠ å¹¶å‘é™åˆ¶
```

### 3. ç¼“å­˜ç­–ç•¥

- ä½¿ç”¨Redisç¼“å­˜é¢‘ç¹æŸ¥è¯¢
- å®ç°è®°å¿†é¢„åŠ è½½
- æ‰¹é‡å¤„ç†è¯·æ±‚

## ğŸ” å®‰å…¨å»ºè®®

1. **ä¿æŠ¤APIå¯†é’¥**ï¼š
   - ä¸è¦å°†`.env`æ–‡ä»¶æäº¤åˆ°Git
   - ä½¿ç”¨å¯†é’¥ç®¡ç†æœåŠ¡ï¼ˆå¦‚AWS Secrets Managerï¼‰

2. **å¯ç”¨HTTPS**ï¼š
   - ç”Ÿäº§ç¯å¢ƒä½¿ç”¨åå‘ä»£ç†ï¼ˆNginxï¼‰
   - é…ç½®SSLè¯ä¹¦

3. **APIé™æµ**ï¼š
   - å®ç°é€Ÿç‡é™åˆ¶
   - ä½¿ç”¨ä»¤ç‰Œæ¡¶ç®—æ³•

4. **è¾“å…¥éªŒè¯**ï¼š
   - æ¸…ç†ç”¨æˆ·è¾“å…¥
   - é™åˆ¶è¯·æ±‚å¤§å°

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [Graphitiå®˜æ–¹æ–‡æ¡£](https://github.com/getzep/graphiti)
- [Neo4jå®˜æ–¹æ–‡æ¡£](https://neo4j.com/docs/)
- [DeepSeek APIæ–‡æ¡£](https://platform.deepseek.com/api-docs/)
- [ç¡…åŸºæµåŠ¨APIæ–‡æ¡£](https://docs.siliconflow.cn/)
- [SillyTavernæ–‡æ¡£](https://docs.sillytavern.app/)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Forkæœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ã€‚è¯¦è§[LICENSE](LICENSE)æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [Graphiti](https://github.com/getzep/graphiti) - çŸ¥è¯†å›¾è°±æ¡†æ¶
- [Neo4j](https://neo4j.com/) - å›¾æ•°æ®åº“
- [FastAPI](https://fastapi.tiangolo.com/) - Webæ¡†æ¶
- [SillyTavern](https://github.com/SillyTavern/SillyTavern) - AIå‰ç«¯

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µ: https://github.com/2211427551/Exp_Graphiti_MemR3_AIRP_Intergration
- é—®é¢˜åé¦ˆ: https://github.com/2211427551/Exp_Graphiti_MemR3_AIRP_Intergration/issues
